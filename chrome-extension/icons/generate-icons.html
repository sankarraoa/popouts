<!DOCTYPE html>
<html>
<head>
  <title>Popouts Icon Generator</title>
  <style>
    body {
      padding: 20px;
      font-family: 'Roboto', Arial, sans-serif;
      max-width: 600px;
      margin: 0 auto;
      background: linear-gradient(135deg, #2196F3 0%, #1565C0 100%);
      color: white;
    }
    canvas {
      border: 2px solid rgba(255, 255, 255, 0.2);
      margin: 10px;
      display: block;
      border-radius: 8px;
      background: white;
    }
    button {
      padding: 12px 24px;
      margin: 10px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      cursor: pointer;
      backdrop-filter: blur(10px);
      transition: all 0.3s;
      font-weight: 500;
    }
    button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .status {
      margin: 10px 0;
      padding: 12px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      backdrop-filter: blur(10px);
    }
    h1 {
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      font-weight: 400;
    }
  </style>
</head>
<body>
  <h1>Popouts Icon Generator</h1>
  <p>Material Design style icon with blue/dark blue colors</p>
  <button onclick="generateIcons()">Generate All Icons</button>
  <div id="status" class="status">Ready to generate icons...</div>
  <div id="canvases"></div>
  
  <script>
    // Material Design style icon - Blue to dark blue
    // Simple, clean geometric design with pop-out effect
    const svgString = `<svg width="128" height="128" viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#2196F3;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1" />
        </linearGradient>
      </defs>
      
      <!-- Rounded square background (Material Design style) -->
      <rect width="128" height="128" rx="20" fill="url(#blueGradient)"/>
      
      <!-- Main pop-out shape - folded corner effect -->
      <path d="M32 32 L96 32 L96 96 L32 96 Z" fill="white" fill-opacity="0.95"/>
      
      <!-- Folded corner triangle -->
      <path d="M80 32 L96 32 L96 48 Z" fill="white" fill-opacity="0.85"/>
      
      <!-- Inner shadow line for folded corner -->
      <line x1="80" y1="32" x2="96" y2="48" stroke="rgba(21, 101, 192, 0.3)" stroke-width="1.5"/>
      
      <!-- Pop-out indicator lines (Material style) -->
      <line x1="96" y1="32" x2="104" y2="24" stroke="white" stroke-width="3" stroke-linecap="round" opacity="0.9"/>
      <line x1="96" y1="48" x2="104" y2="56" stroke="white" stroke-width="3" stroke-linecap="round" opacity="0.9"/>
      
      <!-- Simple geometric accent (Material style dots) -->
      <circle cx="48" cy="48" r="4" fill="#1565C0" opacity="0.6"/>
      <circle cx="64" cy="48" r="4" fill="#1565C0" opacity="0.6"/>
      <circle cx="80" cy="48" r="4" fill="#1565C0" opacity="0.6"/>
    </svg>`;

    function updateStatus(message) {
      const status = document.getElementById('status');
      status.textContent = message;
    }

    function downloadCanvas(canvas, filename) {
      return new Promise((resolve) => {
        canvas.toBlob(function(blob) {
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          setTimeout(() => {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            resolve();
          }, 100);
        }, 'image/png');
      });
    }

    async function generateIcons() {
      const sizes = [16, 48, 128];
      const canvases = document.getElementById('canvases');
      canvases.innerHTML = '';
      updateStatus('Generating Material Design icons...');
      
      const blob = new Blob([svgString], {type: 'image/svg+xml;charset=utf-8'});
      const svgUrl = URL.createObjectURL(blob);
      
      for (let i = 0; i < sizes.length; i++) {
        const size = sizes[i];
        updateStatus(`Generating icon${size}.png (${i + 1}/3)...`);
        
        const canvas = document.createElement('canvas');
        canvas.width = size;
        canvas.height = size;
        canvas.id = `canvas${size}`;
        canvases.appendChild(canvas);
        
        const ctx = canvas.getContext('2d');
        const img = new Image();
        
        await new Promise((resolve) => {
          img.onload = async function() {
            try {
              ctx.drawImage(img, 0, 0, size, size);
              await downloadCanvas(canvas, `icon${size}.png`);
              updateStatus(`✓ Downloaded icon${size}.png (${i + 1}/3)`);
            } catch (error) {
              updateStatus(`✗ Error downloading icon${size}.png: ${error.message}`);
            }
            resolve();
          };
          
          img.onerror = function() {
            updateStatus(`✗ Error loading SVG for icon${size}.png`);
            resolve();
          };
          
          img.src = svgUrl;
        });
        
        // Longer delay between downloads to ensure browser processes them
        // Some browsers block rapid downloads
        await new Promise(resolve => setTimeout(resolve, 500));
      }
      
      URL.revokeObjectURL(svgUrl);
      updateStatus('✓ All icons generated! Check your downloads folder. You should have icon16.png, icon48.png, and icon128.png. Move them to the icons/ folder and reload the extension.');
    }
  </script>
</body>
</html>
